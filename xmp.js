!function(){"use strict";if(window.SA?.xmp)return;function t(t){const n=(new TextEncoder).encode(String(t||"")+"\0"),e=n.length,r=1&e,o=new Uint8Array(20+e+r),a=new DataView(o.buffer);o.set([76,73,83,84],0),a.setUint32(4,12+e+r,!0),o.set([73,78,70,79],8);const f=new Uint8Array([73,67,77,84,255&e,e>>8&255,e>>16&255,e>>24&255]);return o.set(f,12),o.set(n,20),r&&(o[20+e]=0),o}window.SA=window.SA||{};window.SA.xmp={buildXmpXml_XnViewCompat:function({creator:t="",description:n="",keywords:e=[],sourceUrl:r="",title:o="",createDateISO:a="",modifyDateISO:f=""}){const s=t=>String(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),i=t=>`<rdf:Bag>${t.filter(Boolean).map((t=>`<rdf:li>${s(t)}</rdf:li>`)).join("")}</rdf:Bag>`,c=t=>String(t||"").replace(/Z$/,"").replace(/\.\d+Z?$/,"").replace(/\.\d+$/,"");return`<?xpacket begin="\ufeff" id="W5M0MpCehiHzreSzNTczkc9d"?>\n  <x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 6.0.0">\n    <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n      <rdf:Description rdf:about=""\n        xmlns:dc="http://purl.org/dc/elements/1.1/"\n        xmlns:xmp="http://ns.adobe.com/xap/1.0/"\n        xmlns:lr="http://ns.adobe.com/lightroom/1.0/"\n        xmlns:photoshop="http://ns.adobe.com/photoshop/1.0/">\n  \n        ${t?`<dc:creator>${s(t)}</dc:creator>`:""}\n        ${n?`<dc:description>${s(n)}</dc:description>`:""}\n        ${e&&e.length?`<dc:subject>${i(e)}</dc:subject>`:""}\n        ${o?`<dc:title>${s(o)}</dc:title>`:""}\n        ${a?`<xmp:CreateDate>${s(c(a))}</xmp:CreateDate>`:""}\n        ${f?`<xmp:ModifyDate>${s(c(f))}</xmp:ModifyDate>`:""}\n        ${e&&e.length?`<lr:hierarchicalSubject>${i(e)}</lr:hierarchicalSubject>`:""}\n        ${r?`<photoshop:Source>${s(r)}</photoshop:Source>`:""}\n  \n      </rdf:Description>\n    </rdf:RDF>\n  </x:xmpmeta>\n  <?xpacket end="w"?>`},insertXmpIntoWebP:function(n,e,r){const o=new Uint8Array(n),a=new DataView(o.buffer,o.byteOffset,o.byteLength),f=t=>String.fromCharCode(o[t],o[t+1],o[t+2],o[t+3]),s=t=>a.getUint32(t,!0);if("RIFF"!==f(0)||"WEBP"!==f(8))throw new Error("Not a RIFF WEBP");const i=[];let c=12;for(;c+8<=o.length;){const t=f(c),n=s(c+4),e=c+8,r=e+n;if(r>o.length)break;i.push({fourCC:t,off:c,sz:n,dataStart:e,dataEnd:r}),c=r+(1&n)}const d=i.findIndex((t=>"VP8X"===t.fourCC)),u=i.findIndex((t=>"VP8 "===t.fourCC)),l=i.findIndex((t=>"VP8L"===t.fourCC));i.findIndex((t=>"ALPH"===t.fourCC)),i.findIndex((t=>"ANIM"===t.fourCC)),i.findIndex((t=>"ANMF"===t.fourCC)),i.findIndex((t=>"EXIF"===t.fourCC)),i.findIndex((t=>"ICCP"===t.fourCC));let h=i.findIndex((t=>"XMP "===t.fourCC));-1!==u&&function(t){const n=o.subarray(t.dataStart,Math.min(t.dataEnd,t.dataStart+30));if(n.length>=10&&157===n[3]&&1===n[4]&&42===n[5]){return{w:16383&(n[6]|n[7]<<8),h:16383&(n[8]|n[9]<<8)}}return null}(i[u])||-1!==l&&function(t){const n=o.subarray(t.dataStart,Math.min(t.dataEnd,t.dataStart+10));if(n.length>=5&&47===n[0]){n[1];const t=n[2],e=n[3];return{w:1+(t|(63&e)<<8),h:1+((e>>6|n[4]<<2|(15&n[5])<<10)>>>0)}}}(i[l]);const p=(new TextEncoder).encode(String(e||"")),w=p.length,g=1&w?1:0,C=new Uint8Array(8+w+g);C.set([88,77,80,32],0),new DataView(C.buffer).setUint32(4,w,!0),C.set(p,8),g&&(C[8+w]=0);const m=[];function x(t,n){n>t&&m.push(o.slice(t,n))}if(-1!==h){const n=i[h];x(0,n.off),m.push(C),r&&m.push(t(r)),x(n.dataEnd+(1&n.sz),o.length)}else if(-1!==d){const n=i[d].off+8+i[d].sz+(1&i[d].sz);x(0,n),m.push(C),r&&m.push(t(r)),x(n,o.length)}else{const t=-1!==u?u:l;if(-1!==t){const n=i[t].off;x(0,n),m.push(C),x(n,o.length)}else x(0,o.length),m.push(C)}let b=function(t){const n=t.reduce(((t,n)=>t+n.length),0),e=new Uint8Array(n);let r=0;for(const n of t)e.set(n,r),r+=n.length;return e}(m);return b=function(t){const n=new DataView(t.buffer,t.byteOffset,t.byteLength),e=n=>String.fromCharCode(t[n],t[n+1],t[n+2],t[n+3]),r=[];let o=12;for(;o+8<=t.length;){const a=e(o),f=n.getUint32(o+4,!0),s=o+8,i=s+f;if(i>t.length)break;r.push({fourCC:a,off:o,sz:f,dataStart:s,dataEnd:i,pad:1&f}),o=i+(1&f)}const a=r.find((t=>"VP8 "===t.fourCC)),f=r.find((t=>"VP8L"===t.fourCC)),s=a&&function(n){const e=n.dataStart;if(e+10>t.length)return null;if(157===t[e+3]&&1===t[e+4]&&42===t[e+5]){return{w:16383&(t[e+6]|t[e+7]<<8),h:16383&(t[e+8]|t[e+9]<<8)}}return null}(a)||f&&function(n){const e=n.dataStart;if(e+5>t.length)return null;if(47!==t[e])return null;const r=t[e+1],o=t[e+2];return{w:1+(r|(63&o)<<8),h:1+(o>>>6|t[e+3]<<2|(15&t[e+4])<<10)}}(f);if(!s)throw new Error("rebuildVP8X: cannot determine canvas size from VP8/VP8L");const i=t=>r.some((n=>n.fourCC===t)),c=i("ICCP"),d=i("EXIF"),u=i("XMP "),l=i("ANIM")||i("ANMF");let h=0;c&&(h|=32),(i("ALPH")||!!f)&&(h|=16),d&&(h|=8),u&&(h|=4),l&&(h|=2);const p=Math.max(1,s.w)-1,w=Math.max(1,s.h)-1,g=new Uint8Array(10);g[0]=h,g[4]=255&p,g[5]=p>>>8&255,g[6]=p>>>16&255,g[7]=255&w,g[8]=w>>>8&255,g[9]=w>>>16&255;const C=new Uint8Array(18);C.set([86,80,56,88],0),new DataView(C.buffer).setUint32(4,10,!0),C.set(g,8);const m=[];m.push(t.slice(0,12)),m.push(C);for(const n of r)"VP8X"!==n.fourCC&&(m.push(t.slice(n.off,n.dataEnd)),1&n.sz&&m.push(t.slice(n.dataEnd,n.dataEnd+1)));let x=0;for(const t of m)x+=t.length;const b=new Uint8Array(x);let S=0;for(const t of m)b.set(t,S),S+=t.length;return new DataView(b.buffer).setUint32(4,b.length-8,!0),new DataView(b.buffer).getUint32(16,!0),b}(b),b.buffer.slice(b.byteOffset,b.byteOffset+b.byteLength)}}}();